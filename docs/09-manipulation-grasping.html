<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-09-manipulation-grasping" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Chapter 9: Manipulation &amp; Grasping | Physical AI &amp; Humanoid Robotics</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://shumailaaijaz.github.io/physical-ai-textbook/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://shumailaaijaz.github.io/physical-ai-textbook/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://shumailaaijaz.github.io/physical-ai-textbook/docs/09-manipulation-grasping"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Chapter 9: Manipulation &amp; Grasping | Physical AI &amp; Humanoid Robotics"><meta data-rh="true" name="description" content="&quot;The hand is the visible part of the brain.&quot; ‚Äî Immanuel Kant"><meta data-rh="true" property="og:description" content="&quot;The hand is the visible part of the brain.&quot; ‚Äî Immanuel Kant"><link data-rh="true" rel="icon" href="/physical-ai-textbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://shumailaaijaz.github.io/physical-ai-textbook/docs/09-manipulation-grasping"><link data-rh="true" rel="alternate" href="https://shumailaaijaz.github.io/physical-ai-textbook/docs/09-manipulation-grasping" hreflang="en"><link data-rh="true" rel="alternate" href="https://shumailaaijaz.github.io/physical-ai-textbook/docs/09-manipulation-grasping" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Chapter 9: Manipulation & Grasping","item":"https://shumailaaijaz.github.io/physical-ai-textbook/docs/09-manipulation-grasping"}]}</script><link rel="alternate" type="application/rss+xml" href="/physical-ai-textbook/blog/rss.xml" title="Physical AI &amp; Humanoid Robotics RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/physical-ai-textbook/blog/atom.xml" title="Physical AI &amp; Humanoid Robotics Atom Feed"><link rel="stylesheet" href="/physical-ai-textbook/assets/css/styles.2bd0a4a8.css">
<script src="/physical-ai-textbook/assets/js/runtime~main.3b1ba462.js" defer="defer"></script>
<script src="/physical-ai-textbook/assets/js/main.4469a88a.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/physical-ai-textbook/img/logo.jpeg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/physical-ai-textbook/"><div class="navbar__logo"><img src="/physical-ai-textbook/img/logo.jpeg" alt="Physical AI Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" style="border-radius:50%;width:40px;height:40px"><img src="/physical-ai-textbook/img/logo.jpeg" alt="Physical AI Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" style="border-radius:50%;width:40px;height:40px"></div><b class="navbar__title text--truncate">Physical AI Textbook</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/physical-ai-textbook/docs/00-preface">Textbook</a><a class="navbar__item navbar__link" href="/physical-ai-textbook/blog">Blog</a><a class="navbar__item navbar__link" href="/physical-ai-textbook/chatbot">AI Chatbot</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/Shumailaaijaz/physical-ai-labs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Labs<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/Shumailaaijaz/physical-ai-textbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/physical-ai-textbook/login">Login</a><a class="navbar__item navbar__link" href="/physical-ai-textbook/signup">Sign Up</a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/00-preface"><span title="Preface" class="linkLabel_WmDU">Preface</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/01-introduction-to-physical-ai"><span title="Chapter 1: Introduction to Physical AI" class="linkLabel_WmDU">Chapter 1: Introduction to Physical AI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/02-ros2-fundamentals"><span title="Chapter 2: ROS 2 Fundamentals" class="linkLabel_WmDU">Chapter 2: ROS 2 Fundamentals</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/03-urdf-robot-modeling"><span title="Chapter 3: URDF &amp; Robot Modeling" class="linkLabel_WmDU">Chapter 3: URDF &amp; Robot Modeling</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/04-gazebo-simulation"><span title="Chapter 4: Gazebo Simulation" class="linkLabel_WmDU">Chapter 4: Gazebo Simulation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/05-unity-robotics-hub"><span title="Chapter 5: Unity Robotics Hub" class="linkLabel_WmDU">Chapter 5: Unity Robotics Hub</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/06-isaac-sim-basics"><span title="Chapter 6: NVIDIA Isaac Sim Basics" class="linkLabel_WmDU">Chapter 6: NVIDIA Isaac Sim Basics</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/07-isaac-ros-integration"><span title="Chapter 7: Isaac ROS Integration" class="linkLabel_WmDU">Chapter 7: Isaac ROS Integration</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/08-legged-locomotion"><span title="Chapter 8: Legged Locomotion" class="linkLabel_WmDU">Chapter 8: Legged Locomotion</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/physical-ai-textbook/docs/09-manipulation-grasping"><span title="Chapter 9: Manipulation &amp; Grasping" class="linkLabel_WmDU">Chapter 9: Manipulation &amp; Grasping</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/10-vision-language-action"><span title="Chapter 10: Vision-Language-Action (VLA) Models" class="linkLabel_WmDU">Chapter 10: Vision-Language-Action (VLA) Models</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/11-capstone-project"><span title="Chapter 11: Capstone Project" class="linkLabel_WmDU">Chapter 11: Capstone Project</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/12-hardware-guide"><span title="Chapter 12: Hardware Guide" class="linkLabel_WmDU">Chapter 12: Hardware Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/13-ethics-future-physical-ai"><span title="Chapter 13: Ethics &amp; Future of Physical AI" class="linkLabel_WmDU">Chapter 13: Ethics &amp; Future of Physical AI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/example-diagrams"><span title="Example Diagrams" class="linkLabel_WmDU">Example Diagrams</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/physical-ai-textbook/docs/CHAPTER_OUTLINES"><span title="Chapter Outlines: Physical AI &amp; Humanoid Robotics Textbook" class="linkLabel_WmDU">Chapter Outlines: Physical AI &amp; Humanoid Robotics Textbook</span></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div style="display:flex;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap;position:sticky;top:60px;z-index:100;background-color:var(--ifm-background-color);padding:0.5rem 0;border-bottom:1px solid var(--ifm-color-emphasis-200)"><div class="urduTranslate_pQle"><button class="translateButton_xb_Y" aria-label="View in Urdu">üáµüá∞ ÿßÿ±ÿØŸà ŸÖ€å⁄∫ ÿØ€å⁄©⁄æ€å⁄∫ (View in Urdu)</button></div></div><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/physical-ai-textbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Chapter 9: Manipulation &amp; Grasping</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Chapter 9: Manipulation &amp; Grasping</h1></header>
<blockquote>
<p><em>&quot;The hand is the visible part of the brain.&quot; ‚Äî Immanuel Kant</em></p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="learning-objectives">Learning Objectives<a href="#learning-objectives" class="hash-link" aria-label="Direct link to Learning Objectives" title="Direct link to Learning Objectives" translate="no">‚Äã</a></h2>
<p>By the end of this chapter, you will be able to:</p>
<ol>
<li class=""><strong>Solve inverse kinematics</strong> for robot arms</li>
<li class=""><strong>Plan collision-free trajectories</strong> with MoveIt 2</li>
<li class=""><strong>Implement grasp planning</strong> algorithms</li>
<li class=""><strong>Use force control</strong> for compliant manipulation</li>
<li class=""><strong>Integrate vision</strong> (object detection) + manipulation</li>
</ol>
<p><strong>Estimated Time</strong>: 8-10 hours (reading + labs)</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="91-introduction-manipulation-challenges">9.1 Introduction: Manipulation Challenges<a href="#91-introduction-manipulation-challenges" class="hash-link" aria-label="Direct link to 9.1 Introduction: Manipulation Challenges" title="Direct link to 9.1 Introduction: Manipulation Challenges" translate="no">‚Äã</a></h2>
<p>Picking up a cup seems trivial to humans. For robots, it requires solving multiple hard problems:</p>
<p><strong>Challenges</strong>:</p>
<ol>
<li class=""><strong>Redundancy</strong>: 7-DOF arm has infinite solutions for the same end-effector pose (elbow up vs down)</li>
<li class=""><strong>Grasp stability</strong>: Where to place fingers? (force closure, contact points)</li>
<li class=""><strong>Collision avoidance</strong>: Don&#x27;t hit the table, other objects, or yourself</li>
<li class=""><strong>Perception uncertainty</strong>: Object pose may be off by 1-2cm (enough to fail grasp)</li>
<li class=""><strong>Contact forces</strong>: Too weak ‚Üí object slips; too strong ‚Üí object breaks</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="911-state-of-the-art">9.1.1 State of the Art<a href="#911-state-of-the-art" class="hash-link" aria-label="Direct link to 9.1.1 State of the Art" title="Direct link to 9.1.1 State of the Art" translate="no">‚Äã</a></h3>
<p><strong>Franka Emika Panda</strong> (research standard):</p>
<ul>
<li class="">7-DOF arm (redundant)</li>
<li class="">Parallel-jaw gripper (max 0.08m opening)</li>
<li class="">Torque sensors (all 7 joints)</li>
<li class=""><strong>Price</strong>: $25,000</li>
</ul>
<p><strong>Unitree Z1</strong> (budget option):</p>
<ul>
<li class="">6-DOF arm</li>
<li class="">Gripper with force sensing</li>
<li class=""><strong>Price</strong>: $3,000</li>
</ul>
<p><strong>Unitree G1 Humanoid</strong>:</p>
<ul>
<li class="">Dual 7-DOF arms (whole-body manipulation)</li>
<li class="">3-finger dexterous hands</li>
<li class=""><strong>Use case</strong>: Bi-manual tasks (opening jars, folding clothes)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="92-forward-and-inverse-kinematics">9.2 Forward and Inverse Kinematics<a href="#92-forward-and-inverse-kinematics" class="hash-link" aria-label="Direct link to 9.2 Forward and Inverse Kinematics" title="Direct link to 9.2 Forward and Inverse Kinematics" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="921-denavit-hartenberg-dh-parameters">9.2.1 Denavit-Hartenberg (DH) Parameters<a href="#921-denavit-hartenberg-dh-parameters" class="hash-link" aria-label="Direct link to 9.2.1 Denavit-Hartenberg (DH) Parameters" title="Direct link to 9.2.1 Denavit-Hartenberg (DH) Parameters" translate="no">‚Äã</a></h3>
<p><strong>DH Convention</strong>: Standard way to describe robot arm geometry.</p>
<p>Each joint has 4 parameters:</p>
<ul>
<li class=""><code>Œ∏</code>: Joint angle (revolute) or displacement (prismatic)</li>
<li class=""><code>d</code>: Link offset along z-axis</li>
<li class=""><code>a</code>: Link length along x-axis</li>
<li class=""><code>Œ±</code>: Link twist (rotation about x-axis)</li>
</ul>
<p><strong>Example</strong>: PUMA 560 arm (classic 6-DOF)</p>
<table><thead><tr><th>Joint</th><th>Œ∏</th><th>d</th><th>a</th><th>Œ±</th></tr></thead><tbody><tr><td>1</td><td>Œ∏‚ÇÅ*</td><td>0</td><td>0</td><td>90¬∞</td></tr><tr><td>2</td><td>Œ∏‚ÇÇ*</td><td>0</td><td>0.4318</td><td>0¬∞</td></tr><tr><td>3</td><td>Œ∏‚ÇÉ*</td><td>0.15005</td><td>0.0203</td><td>-90¬∞</td></tr><tr><td>4</td><td>Œ∏‚ÇÑ*</td><td>0.4318</td><td>0</td><td>90¬∞</td></tr><tr><td>5</td><td>Œ∏‚ÇÖ*</td><td>0</td><td>0</td><td>-90¬∞</td></tr><tr><td>6</td><td>Œ∏‚ÇÜ*</td><td>0</td><td>0</td><td>0¬∞</td></tr></tbody></table>
<p>(*) Variable (controlled by motors)</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="922-forward-kinematics-fk">9.2.2 Forward Kinematics (FK)<a href="#922-forward-kinematics-fk" class="hash-link" aria-label="Direct link to 9.2.2 Forward Kinematics (FK)" title="Direct link to 9.2.2 Forward Kinematics (FK)" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Given joint angles Œ∏‚ÇÅ, Œ∏‚ÇÇ, ..., Œ∏‚Çô, find end-effector pose.</p>
<p><strong>Homogeneous Transformation Matrix</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">T = T‚ÇÅ T‚ÇÇ T‚ÇÉ T‚ÇÑ T‚ÇÖ T‚ÇÜ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Where each T·µ¢ is:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[cos(Œ∏·µ¢)  -sin(Œ∏·µ¢)cos(Œ±·µ¢)   sin(Œ∏·µ¢)sin(Œ±·µ¢)   a·µ¢cos(Œ∏·µ¢)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[sin(Œ∏·µ¢)   cos(Œ∏·µ¢)cos(Œ±·µ¢)  -cos(Œ∏·µ¢)sin(Œ±·µ¢)   a·µ¢sin(Œ∏·µ¢)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   0          sin(Œ±·µ¢)           cos(Œ±·µ¢)           d·µ¢     ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[   0             0                  0               1      ]</span><br></span></code></pre></div></div>
<p><strong>Code Example</strong> (using modern robotics library):</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> modern_robotics </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> FKinSpace</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Screw axes (spatial)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Slist </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.4</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">0.8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">   </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">    </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">T</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Home configuration (end-effector pose at Œ∏ = 0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">M </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Joint angles</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">theta </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Compute FK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">T </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FKinSpace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">M</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Slist</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> theta</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;End-effector pose:&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">T</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># [[ 0.707  0.707  0     0.883]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  [-0.707  0.707  0     0    ]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  [ 0      0      1     0.283]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#  [ 0      0      0     1    ]]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="923-inverse-kinematics-ik">9.2.3 Inverse Kinematics (IK)<a href="#923-inverse-kinematics-ik" class="hash-link" aria-label="Direct link to 9.2.3 Inverse Kinematics (IK)" title="Direct link to 9.2.3 Inverse Kinematics (IK)" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Given desired end-effector pose, find joint angles.</p>
<p><strong>Analytical IK</strong> (closed-form):</p>
<ul>
<li class="">Only possible for specific arm geometries (6-DOF with spherical wrist)</li>
<li class="">Fast (microseconds)</li>
<li class="">Example: PUMA 560, UR5</li>
</ul>
<p><strong>Numerical IK</strong> (iterative):</p>
<ul>
<li class="">Works for any arm</li>
<li class="">Slower (milliseconds)</li>
<li class="">Methods: Jacobian pseudoinverse, Newton-Raphson, Levenberg-Marquardt</li>
</ul>
<p><strong>Code Example</strong>: Numerical IK using PyKDL</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PyKDL </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> kdl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Define robot chain (6-DOF)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Chain</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.4318</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.0203</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.15005</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.4318</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pi</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">addSegment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Segment</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Joint</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RotZ</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">DH</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># IK solver</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ik_solver </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ChainIkSolverPos_LMA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Desired pose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Frame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Rotation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">RPY</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Vector</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0.5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Initial guess</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q_init </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">JntArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Solve IK</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> kdl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">JntArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ik_solver</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CartToJnt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q_init</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> q_out</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;IK solution (radians):&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> i </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;  Joint </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:#393A34">+</span><span class="token string-interpolation interpolation number" style="color:#36acaa">1</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">q_out</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">[</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">]</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;IK failed (target unreachable)&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="924-redundancy-7-dof-arms">9.2.4 Redundancy (7-DOF Arms)<a href="#924-redundancy-7-dof-arms" class="hash-link" aria-label="Direct link to 9.2.4 Redundancy (7-DOF Arms)" title="Direct link to 9.2.4 Redundancy (7-DOF Arms)" translate="no">‚Äã</a></h3>
<p><strong>Problem</strong>: 7-DOF arm has infinite IK solutions for the same end-effector pose.</p>
<p><strong>Use redundancy for</strong>:</p>
<ul>
<li class=""><strong>Obstacle avoidance</strong>: Choose elbow configuration that avoids table</li>
<li class=""><strong>Joint limit avoidance</strong>: Stay away from joint limits (safer)</li>
<li class=""><strong>Secondary tasks</strong>: Optimize energy, manipulability</li>
</ul>
<p><strong>Null-space projection</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Primary task: Reach target (6D)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">J </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_jacobian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 6x7 Jacobian</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dq_primary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">J</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> @ dx_desired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Secondary task: Minimize joint deviation from home</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">q_home </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dq_secondary </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">q_home </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Project secondary task into null space</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">N </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">eye</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">J</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> @ J  </span><span class="token comment" style="color:#999988;font-style:italic"># Null-space projector</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dq_total </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> dq_primary </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> N @ dq_secondary</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="93-moveit-2">9.3 MoveIt 2<a href="#93-moveit-2" class="hash-link" aria-label="Direct link to 9.3 MoveIt 2" title="Direct link to 9.3 MoveIt 2" translate="no">‚Äã</a></h2>
<p><strong>MoveIt 2</strong> is the ROS 2 motion planning framework. It provides:</p>
<ul>
<li class=""><strong>Motion planning</strong>: RRT, RRT*, OMPL library</li>
<li class=""><strong>Collision checking</strong>: FCL (Flexible Collision Library)</li>
<li class=""><strong>Trajectory execution</strong>: Smooth interpolation</li>
<li class=""><strong>MoveGroup interface</strong>: Python/C++ API</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="931-moveit-architecture">9.3.1 MoveIt Architecture<a href="#931-moveit-architecture" class="hash-link" aria-label="Direct link to 9.3.1 MoveIt Architecture" title="Direct link to 9.3.1 MoveIt Architecture" translate="no">‚Äã</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[User Goal] ‚Üí [MoveGroup] ‚Üí [Planning Scene] ‚Üí [OMPL Planner] ‚Üí [Trajectory] ‚Üí [Controller]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                  ‚Üì</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [Collision Checker]</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="932-installation">9.3.2 Installation<a href="#932-installation" class="hash-link" aria-label="Direct link to 9.3.2 Installation" title="Direct link to 9.3.2 Installation" translate="no">‚Äã</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># On Ubuntu 22.04</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-humble-moveit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Install MoveIt Python interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo apt install ros-humble-moveit-py</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="933-basic-usage">9.3.3 Basic Usage<a href="#933-basic-usage" class="hash-link" aria-label="Direct link to 9.3.3 Basic Usage" title="Direct link to 9.3.3 Basic Usage" translate="no">‚Äã</a></h3>
<p><strong>Example</strong>: Plan and execute pick-and-place</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> rclpy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> rclpy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">node </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> moveit_py </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> MoveItPy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> geometry_msgs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">msg </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> PoseStamped</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PickAndPlace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;pick_and_place&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Initialize MoveIt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MoveItPy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node_name</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;moveit_py&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveit</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_planning_component</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;manipulator&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> object_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Plan and execute grasp motion.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">            object_pose: Pose of object to grasp</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 1. Move to pre-grasp pose (10cm above object)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pre_grasp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pre_grasp</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_goal_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pose_stamped_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pre_grasp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        plan1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> plan1</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">val </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Success</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_logger</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Planning failed!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 2. Open gripper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">open_gripper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 3. Move down to grasp pose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_goal_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pose_stamped_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">object_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        plan2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 4. Close gripper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">close_gripper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 5. Lift object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_goal_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pose_stamped_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">pre_grasp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        plan3 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">place</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> place_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;Similar to pick, but reverse order.&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># (Implementation similar to pick)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open_gripper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Send gripper command (hardware-specific)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">close_gripper</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">pass</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">init</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PickAndPlace</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Define object pose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PoseStamped</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">header</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">frame_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;base_link&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">orientation</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">w </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Execute pick</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    node</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">object_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rclpy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">spin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="934-motion-planners">9.3.4 Motion Planners<a href="#934-motion-planners" class="hash-link" aria-label="Direct link to 9.3.4 Motion Planners" title="Direct link to 9.3.4 Motion Planners" translate="no">‚Äã</a></h3>
<p>MoveIt uses <strong>OMPL (Open Motion Planning Library)</strong>:</p>
<table><thead><tr><th><strong>Planner</strong></th><th><strong>Speed</strong></th><th><strong>Optimality</strong></th><th><strong>Use Case</strong></th></tr></thead><tbody><tr><td><strong>RRT</strong></td><td>Fast</td><td>Poor</td><td>Quick feasibility check</td></tr><tr><td><strong>RRT</strong>*</td><td>Medium</td><td>Good</td><td>General-purpose</td></tr><tr><td><strong>PRM</strong></td><td>Slow (multi-query)</td><td>Good</td><td>Repeated queries in same environment</td></tr><tr><td><strong>STOMP</strong></td><td>Medium</td><td>Good</td><td>Smooth trajectories (collision-free)</td></tr></tbody></table>
<p><strong>Configure planner</strong>:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># moveit_config/ompl_planning.yaml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">manipulator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">planner_configs</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> RRTConnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain"> RRTstar</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">projection_evaluator</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> joints(joint1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">joint2)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="94-grasp-planning">9.4 Grasp Planning<a href="#94-grasp-planning" class="hash-link" aria-label="Direct link to 9.4 Grasp Planning" title="Direct link to 9.4 Grasp Planning" translate="no">‚Äã</a></h2>
<p><strong>Problem</strong>: Where to place fingers on an object?</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="941-force-closure">9.4.1 Force Closure<a href="#941-force-closure" class="hash-link" aria-label="Direct link to 9.4.1 Force Closure" title="Direct link to 9.4.1 Force Closure" translate="no">‚Äã</a></h3>
<p><strong>Definition</strong>: Grasp achieves force closure if contact forces can resist <strong>any</strong> external wrench (force + torque).</p>
<p><strong>2D Example</strong>: Grasping a box</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  F‚ÇÅ ‚îÇ        ‚îÇ F‚ÇÇ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ‚Üê  ‚îÇ  Box   ‚îÇ  ‚Üí</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</span><br></span></code></pre></div></div>
<p><strong>Force closure</strong>: F‚ÇÅ and F‚ÇÇ point inward, opposing each other.</p>
<p><strong>Not force closure</strong>: F‚ÇÅ and F‚ÇÇ parallel (cannot resist torques).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="942-antipodal-grasps">9.4.2 Antipodal Grasps<a href="#942-antipodal-grasps" class="hash-link" aria-label="Direct link to 9.4.2 Antipodal Grasps" title="Direct link to 9.4.2 Antipodal Grasps" translate="no">‚Äã</a></h3>
<p><strong>Parallel-jaw gripper</strong>: Two fingers move in opposite directions.</p>
<p><strong>Antipodal grasp</strong>: Contact normals point towards each other.</p>
<p><strong>Code Example</strong>: Sample antipodal grasps for cylinder</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sample_antipodal_grasps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">object_mesh</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_samples</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Sample antipodal grasps for a mesh.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        object_mesh: Trimesh object</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        num_samples: Number of grasp candidates</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        List of (position, orientation, width) tuples</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grasps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_samples</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Sample random point on surface</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        point1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> face_idx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_mesh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> return_index</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        normal1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_mesh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">face_normals</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">face_idx</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Raycast in opposite direction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ray_origin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> point1 </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> normal1 </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ray_direction </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">normal1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        locations</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_ray</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> index_tri </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_mesh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ray</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">intersects_location</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ray_origins</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ray_origin</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ray_directions</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ray_direction</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">locations</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            point2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> locations</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            normal2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_mesh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">face_normals</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">index_tri</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># Check if normals oppose each other</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dot</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">normal1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> normal2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">0.9</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Nearly opposite</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Grasp center</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                center </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point1 </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> point2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Grasp width</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                width </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point2 </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> point1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token comment" style="color:#999988;font-style:italic"># Grasp orientation (approach direction)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                approach </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> normal1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                grasps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">center</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> approach</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> grasps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example usage</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> trimesh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mesh </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> trimesh</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">primitives</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Cylinder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.03</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> height</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.15</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grasps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sample_antipodal_grasps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">mesh</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_samples</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Found </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation builtin">len</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">(</span><span class="token string-interpolation interpolation">grasps</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">)</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c"> grasp candidates&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Output: Found 87 grasp candidates</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="943-graspnet-learning-based">9.4.3 GraspNet (Learning-Based)<a href="#943-graspnet-learning-based" class="hash-link" aria-label="Direct link to 9.4.3 GraspNet (Learning-Based)" title="Direct link to 9.4.3 GraspNet (Learning-Based)" translate="no">‚Äã</a></h3>
<p><strong>GraspNet-1Billion</strong> (2020): DNN trained on 1 billion synthetic grasps.</p>
<p><strong>Input</strong>: Point cloud (from RGB-D camera)
<strong>Output</strong>: Ranked grasp poses (6D pose + gripper width)</p>
<p><strong>Code Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> graspnetAPI </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> GraspNet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Load pre-trained model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> GraspNet</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">checkpoint_path</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;graspnet_checkpoint.pth&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Capture point cloud from RealSense</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">point_cloud </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> capture_pointcloud</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Nx3 array</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Predict grasps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grasps </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">infer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">point_cloud</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Sort by score</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">grasps_sorted </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">sorted</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">grasps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key</span><span class="token operator" style="color:#393A34">=</span><span class="token keyword" style="color:#00009f">lambda</span><span class="token plain"> g</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> g</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">score</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> reverse</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Best grasp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">best_grasp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> grasps_sorted</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Grasp pose: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">best_grasp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">pose</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Gripper width: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">best_grasp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">width</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">m&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Score: </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">best_grasp</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">.</span><span class="token string-interpolation interpolation">score</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Execute with MoveIt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">execute_grasp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">best_grasp</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="95-force-control">9.5 Force Control<a href="#95-force-control" class="hash-link" aria-label="Direct link to 9.5 Force Control" title="Direct link to 9.5 Force Control" translate="no">‚Äã</a></h2>
<p><strong>Problem</strong>: Position control is rigid (robot ignores contact forces).</p>
<p><strong>Use cases</strong>:</p>
<ul>
<li class=""><strong>Insertion</strong>: Inserting USB plug (requires compliance)</li>
<li class=""><strong>Wiping</strong>: Cleaning table (constant force)</li>
<li class=""><strong>Assembly</strong>: Peg-in-hole (feel for contact)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="951-impedance-control">9.5.1 Impedance Control<a href="#951-impedance-control" class="hash-link" aria-label="Direct link to 9.5.1 Impedance Control" title="Direct link to 9.5.1 Impedance Control" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Act like a spring-damper system.</p>
<p><strong>Control law</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">F = K(x_desired - x) + B(·∫ã_desired - ·∫ã)</span><br></span></code></pre></div></div>
<p>Where:</p>
<ul>
<li class=""><code>K</code>: Stiffness (N/m)</li>
<li class=""><code>B</code>: Damping (Ns/m)</li>
</ul>
<p><strong>Code Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">impedance_controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_desired</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x_current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v_current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> K</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Compute force command for impedance control.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        x_desired: Desired position (m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        x_current: Current position (m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        v_current: Current velocity (m/s)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        K: Stiffness (N/m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        B: Damping (Ns/m)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        F: Force command (N)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x_desired </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> x_current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> K </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> error </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> B </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> v_current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Example: Move to target with compliance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x_target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">v </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dt </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.01</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">m </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># End-effector mass (kg)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> t </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">arange</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    F </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> impedance_controller</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x_target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> v</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> K</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> B</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Simulate dynamics</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> F </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> m</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    v </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> dt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> v </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> dt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string-interpolation string" style="color:#e3116c">f&quot;t=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">t</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, x=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">x</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.3f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">, F=</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">F</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">:</span><span class="token string-interpolation interpolation format-spec">.2f</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="952-admittance-control">9.5.2 Admittance Control<a href="#952-admittance-control" class="hash-link" aria-label="Direct link to 9.5.2 Admittance Control" title="Direct link to 9.5.2 Admittance Control" translate="no">‚Äã</a></h3>
<p><strong>Opposite of impedance</strong>: Sense force ‚Üí produce motion.</p>
<p><strong>Control law</strong>:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">·∫ã = (F_measured - F_desired) / B</span><br></span></code></pre></div></div>
<p><strong>Use case</strong>: Sanding (apply constant force to surface).</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="96-visual-servoing">9.6 Visual Servoing<a href="#96-visual-servoing" class="hash-link" aria-label="Direct link to 9.6 Visual Servoing" title="Direct link to 9.6 Visual Servoing" translate="no">‚Äã</a></h2>
<p><strong>Visual servoing</strong>: Use camera feedback to guide robot motion.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="961-position-based-visual-servoing-pbvs">9.6.1 Position-Based Visual Servoing (PBVS)<a href="#961-position-based-visual-servoing-pbvs" class="hash-link" aria-label="Direct link to 9.6.1 Position-Based Visual Servoing (PBVS)" title="Direct link to 9.6.1 Position-Based Visual Servoing (PBVS)" translate="no">‚Äã</a></h3>
<p><strong>Workflow</strong>:</p>
<ol>
<li class="">Detect object in camera image</li>
<li class="">Estimate object pose (using DOPE, FoundationPose)</li>
<li class="">Compute end-effector target pose</li>
<li class="">Move to target using MoveIt</li>
</ol>
<p><strong>Code Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">pbvs_grasp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">camera</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> detector</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> arm</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Grasp object using position-based visual servoing.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 1. Capture image</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> camera</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">capture</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 2. Detect object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    object_pose </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> detector</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">detect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Returns 6D pose</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> object_pose </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Object not detected!&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 3. Compute grasp pose (offset from object)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grasp_pose </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> object_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    grasp_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">position</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">z </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.15</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Approach from above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 4. Plan and execute</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_goal_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pose_stamped_msg</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">grasp_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plan </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> plan</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">error_code</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">val </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        arm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">else</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="962-image-based-visual-servoing-ibvs">9.6.2 Image-Based Visual Servoing (IBVS)<a href="#962-image-based-visual-servoing-ibvs" class="hash-link" aria-label="Direct link to 9.6.2 Image-Based Visual Servoing (IBVS)" title="Direct link to 9.6.2 Image-Based Visual Servoing (IBVS)" translate="no">‚Äã</a></h3>
<p><strong>Workflow</strong>:</p>
<ol>
<li class="">Track features in image (e.g., corners)</li>
<li class="">Compute image Jacobian (maps joint velocities to feature velocities)</li>
<li class="">Move features towards desired positions</li>
</ol>
<p><strong>Advantage</strong>: No need for 3D pose estimation (works even with calibration errors).</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="97-dual-arm-manipulation">9.7 Dual-Arm Manipulation<a href="#97-dual-arm-manipulation" class="hash-link" aria-label="Direct link to 9.7 Dual-Arm Manipulation" title="Direct link to 9.7 Dual-Arm Manipulation" translate="no">‚Äã</a></h2>
<p><strong>Use cases</strong>:</p>
<ul>
<li class=""><strong>Carry large objects</strong>: Two arms share load</li>
<li class=""><strong>Bi-manual tasks</strong>: Open jar (one hand holds, one unscrews)</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="971-coordination">9.7.1 Coordination<a href="#971-coordination" class="hash-link" aria-label="Direct link to 9.7.1 Coordination" title="Direct link to 9.7.1 Coordination" translate="no">‚Äã</a></h3>
<p><strong>Challenge</strong>: Synchronize two arms (avoid internal forces).</p>
<p><strong>Approach</strong>: Plan for <strong>relative pose</strong> (maintain grasp while moving).</p>
<p><strong>Code Example</strong>:</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dual_arm_carry</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left_arm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> right_arm</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> object_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> target_pose</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Carry object with two arms.</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        left_arm, right_arm: MoveIt arm interfaces</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        object_pose: Current object pose</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        target_pose: Desired object pose</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Current grasp poses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    left_grasp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_grasp_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">object_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> side</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;left&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    right_grasp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_grasp_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">object_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> side</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;right&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Target grasp poses (maintain relative transform)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    left_target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_grasp_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> side</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;left&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    right_target </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> compute_grasp_pose</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">target_pose</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> side</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;right&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Plan for both arms simultaneously</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multi_arm_planner </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MoveGroupInterface</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;arms&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multi_arm_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_pose_target</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">left_target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end_effector_link</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;left_gripper&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multi_arm_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_pose_target</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">right_target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> end_effector_link</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;right_gripper&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    plan </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> multi_arm_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    multi_arm_planner</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">execute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">plan</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="98-whole-body-manipulation-humanoids">9.8 Whole-Body Manipulation (Humanoids)<a href="#98-whole-body-manipulation-humanoids" class="hash-link" aria-label="Direct link to 9.8 Whole-Body Manipulation (Humanoids)" title="Direct link to 9.8 Whole-Body Manipulation (Humanoids)" translate="no">‚Äã</a></h2>
<p><strong>Advantage</strong>: Use base + torso + arms (12+ DOF total).</p>
<p><strong>Use case</strong>: Reach high shelf (stand on toes + extend arm).</p>
<p><strong>Code Example</strong>: Whole-body IK</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> pinocchio </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> pin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">whole_body_ik</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hand_target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foot_contacts</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    IK for humanoid (optimizes all joints).</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Args:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        model: Pinocchio model</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        data: Pinocchio data</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        hand_target: Desired hand pose</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        foot_contacts: List of foot frame IDs (must stay on ground)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="display:inline-block;color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    Returns:</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">        q: Joint configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    q </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">neutral</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> iteration </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">forwardKinematics</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">computeJointJacobians</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Hand task (priority 1)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hand_id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getFrameId</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;left_hand&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        J_hand </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getFrameJacobian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hand_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOCAL_WORLD_ALIGNED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        current_pose </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">oMf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">hand_id</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error_hand </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hand_target</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">translation </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> current_pose</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">translation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Foot tasks (priority 2: stay on ground)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        errors </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">error_hand</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jacobians </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">J_hand</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># Position only</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> foot_id </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> foot_contacts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            J_foot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">getFrameJacobian</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> foot_id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">LOCAL_WORLD_ALIGNED</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            foot_pos </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">oMf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">foot_id</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">translation</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            error_foot </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> foot_pos  </span><span class="token comment" style="color:#999988;font-style:italic"># Stay at current position</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            errors</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">error_foot</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            jacobians</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">J_foot</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Stack constraints</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        J </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">vstack</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">jacobians</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        e </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">concatenate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">errors</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># Solve</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        dq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pinv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">J</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> @ e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        q </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">integrate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> q</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dq </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> np</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">linalg</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">norm</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-3</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">break</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> q</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="exercises">Exercises<a href="#exercises" class="hash-link" aria-label="Direct link to Exercises" title="Direct link to Exercises" translate="no">‚Äã</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exercise-91-compare-ik-solvers">Exercise 9.1: Compare IK Solvers<a href="#exercise-91-compare-ik-solvers" class="hash-link" aria-label="Direct link to Exercise 9.1: Compare IK Solvers" title="Direct link to Exercise 9.1: Compare IK Solvers" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Implement and benchmark 5 IK solvers:</p>
<ol>
<li class="">Jacobian pseudoinverse</li>
<li class="">Damped least squares</li>
<li class="">PyKDL</li>
<li class="">MoveIt (IKFast)</li>
<li class="">TracIK</li>
</ol>
<p><strong>Metrics</strong>:</p>
<ul>
<li class=""><strong>Speed</strong>: Average solve time (ms)</li>
<li class=""><strong>Success rate</strong>: % of reachable targets solved</li>
<li class=""><strong>Accuracy</strong>: Mean pose error (mm)</li>
</ul>
<p><strong>Expected result</strong>: TracIK wins on success rate; IKFast wins on speed.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exercise-92-stack-3-blocks">Exercise 9.2: Stack 3 Blocks<a href="#exercise-92-stack-3-blocks" class="hash-link" aria-label="Direct link to Exercise 9.2: Stack 3 Blocks" title="Direct link to Exercise 9.2: Stack 3 Blocks" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Use MoveIt to stack 3 blocks (pick-and-place).</p>
<p><strong>Requirements</strong>:</p>
<ul>
<li class="">Blocks start at random positions on table</li>
<li class="">Stack them in order: Red ‚Üí Blue ‚Üí Green</li>
<li class="">Measure success rate over 20 trials</li>
</ul>
<p><strong>Expected</strong>: &gt;85% success with tuned grasp poses.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exercise-93-train-graspnet-on-ycb-objects">Exercise 9.3: Train GraspNet on YCB Objects<a href="#exercise-93-train-graspnet-on-ycb-objects" class="hash-link" aria-label="Direct link to Exercise 9.3: Train GraspNet on YCB Objects" title="Direct link to Exercise 9.3: Train GraspNet on YCB Objects" translate="no">‚Äã</a></h3>
<p><strong>Goal</strong>: Fine-tune GraspNet on YCB dataset (77 household objects).</p>
<p><strong>Steps</strong>:</p>
<ol>
<li class="">Generate synthetic grasps in Isaac Sim (10,000 per object)</li>
<li class="">Train GraspNet model (PyTorch)</li>
<li class="">Evaluate on 10 novel objects</li>
<li class="">Compare to baseline (random grasps)</li>
</ol>
<p><strong>Expected</strong>: GraspNet achieves &gt;80% success vs 40% for random.</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="citations">Citations<a href="#citations" class="hash-link" aria-label="Direct link to Citations" title="Direct link to Citations" translate="no">‚Äã</a></h2>
<ol>
<li class="">
<p>Salisbury, J. K., &amp; Roth, B. (1983). <em>Kinematic and force analysis of articulated mechanical hands.</em> Journal of Mechanisms, Transmissions, and Automation in Design, 105(1), 35-41.</p>
</li>
<li class="">
<p>Chitta, S., Sucan, I., &amp; Cousins, S. (2012). <em>MoveIt! [ROS Topics].</em> IEEE Robotics &amp; Automation Magazine, 19(1), 18-19.</p>
</li>
<li class="">
<p>Kuffner, J. J., &amp; LaValle, S. M. (2000). <em>RRT-connect: An efficient approach to single-query path planning.</em> IEEE International Conference on Robotics and Automation (ICRA), 2, 995-1001.</p>
</li>
<li class="">
<p>Fang, H. S., Wang, C., Gou, M., &amp; Lu, C. (2020). <em>GraspNet-1Billion: A large-scale benchmark for general object grasping.</em> IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), 11444-11453.</p>
</li>
<li class="">
<p>Hogan, N. (1985). <em>Impedance control: An approach to manipulation: Part I‚ÄîTheory.</em> Journal of Dynamic Systems, Measurement, and Control, 107(1), 1-7.</p>
</li>
<li class="">
<p>Hutchinson, S., Hager, G. D., &amp; Corke, P. I. (1996). <em>A tutorial on visual servo control.</em> IEEE Transactions on Robotics and Automation, 12(5), 651-670.</p>
</li>
<li class="">
<p>Beeson, P., &amp; Ames, B. (2015). <em>TRAC-IK: An open-source library for improved solving of generic inverse kinematics.</em> IEEE-RAS International Conference on Humanoid Robots (Humanoids), 928-935.</p>
</li>
<li class="">
<p>Sucan, I. A., &amp; Chitta, S. (2013). <em>MoveIt! Motion planning framework.</em> <a href="http://moveit.ros.org" target="_blank" rel="noopener noreferrer" class="">http://moveit.ros.org</a></p>
</li>
<li class="">
<p>Miller, A. T., &amp; Allen, P. K. (2004). <em>GraspIt! A versatile simulator for robotic grasping.</em> IEEE Robotics &amp; Automation Magazine, 11(4), 110-122.</p>
</li>
<li class="">
<p>Mahler, J., Liang, J., Niyaz, S., Laskey, M., Doan, R., Liu, X., ... &amp; Goldberg, K. (2017). <em>Dex-Net 2.0: Deep learning to plan robust grasps with synthetic point clouds and analytic grasp metrics.</em> Robotics: Science and Systems (RSS).</p>
</li>
<li class="">
<p>Carpentier, J., &amp; Mansard, N. (2018). <em>Analytical derivatives of rigid body dynamics algorithms.</em> Robotics: Science and Systems (RSS).</p>
</li>
<li class="">
<p>Kalakrishnan, M., Chitta, S., Theodorou, E., Pastor, P., &amp; Schaal, S. (2011). <em>STOMP: Stochastic trajectory optimization for motion planning.</em> IEEE International Conference on Robotics and Automation (ICRA), 4569-4574.</p>
</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="hardware-requirements">Hardware Requirements<a href="#hardware-requirements" class="hash-link" aria-label="Direct link to Hardware Requirements" title="Direct link to Hardware Requirements" translate="no">‚Äã</a></h2>
<p><strong>Simulation Only</strong> (recommended):</p>
<ul>
<li class=""><strong>CPU/GPU</strong>: Any modern computer</li>
<li class=""><strong>Software</strong>: MoveIt 2 + Gazebo/RViz</li>
</ul>
<p><strong>Real Hardware</strong> (optional):</p>
<ul>
<li class=""><strong>Budget</strong>: Unitree Z1 arm ($3,000)</li>
<li class=""><strong>Research</strong>: Franka Emika Panda ($25,000)</li>
<li class=""><strong>Humanoid</strong>: Unitree G1 ($16,000)</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="labs">Labs<a href="#labs" class="hash-link" aria-label="Direct link to Labs" title="Direct link to Labs" translate="no">‚Äã</a></h2>
<p><strong>Lab 9.1: MoveIt Pick-and-Place</strong></p>
<p><strong>Repository</strong>: <a href="https://github.com/Shumailaaijaz/physical-ai-labs" target="_blank" rel="noopener noreferrer" class="">github.com/Shumailaaijaz/physical-ai-labs</a></p>
<p><strong>Lab Path</strong>: <code>labs/chapter-09-moveit-planning/</code></p>
<p><strong>What&#x27;s Included</strong>:</p>
<ul>
<li class="">MoveIt config for Panda arm</li>
<li class="">Gazebo world with table + blocks</li>
<li class="">Pick-and-place Python script</li>
<li class="">RViz visualization</li>
</ul>
<p><strong>Expected Time</strong>: 2 hours</p>
<hr>
<p><strong>Lab 9.2: GraspNet Inference</strong></p>
<p><strong>Lab Path</strong>: <code>labs/chapter-09-graspnet/</code></p>
<p><strong>What&#x27;s Included</strong>:</p>
<ul>
<li class="">Pre-trained GraspNet checkpoint</li>
<li class="">RealSense D435i point cloud capture</li>
<li class="">Grasp visualization</li>
<li class="">MoveIt execution integration</li>
</ul>
<p><strong>Hardware</strong>: RealSense D435i (or use pre-recorded point clouds)</p>
<p><strong>Expected Time</strong>: 3 hours</p>
<hr>
<p><strong>Next Chapter</strong>: <a class="" href="/physical-ai-textbook/docs/10-vision-language-action">Chapter 10: Vision-Language-Action Models ‚Üí</a></p>
<hr>
<p><em>This textbook is a living document. Found an error? Have a suggestion? Submit an issue or PR at <a href="https://github.com/Shumailaaijaz/physical-ai-textbook" target="_blank" rel="noopener noreferrer" class="">github.com/Shumailaaijaz/physical-ai-textbook</a></em></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/Shumailaaijaz/physical-ai-textbook/tree/main/docs/09-manipulation-grasping.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/physical-ai-textbook/docs/08-legged-locomotion"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Chapter 8: Legged Locomotion</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/physical-ai-textbook/docs/10-vision-language-action"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chapter 10: Vision-Language-Action (VLA) Models</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#learning-objectives" class="table-of-contents__link toc-highlight">Learning Objectives</a></li><li><a href="#91-introduction-manipulation-challenges" class="table-of-contents__link toc-highlight">9.1 Introduction: Manipulation Challenges</a><ul><li><a href="#911-state-of-the-art" class="table-of-contents__link toc-highlight">9.1.1 State of the Art</a></li></ul></li><li><a href="#92-forward-and-inverse-kinematics" class="table-of-contents__link toc-highlight">9.2 Forward and Inverse Kinematics</a><ul><li><a href="#921-denavit-hartenberg-dh-parameters" class="table-of-contents__link toc-highlight">9.2.1 Denavit-Hartenberg (DH) Parameters</a></li><li><a href="#922-forward-kinematics-fk" class="table-of-contents__link toc-highlight">9.2.2 Forward Kinematics (FK)</a></li><li><a href="#923-inverse-kinematics-ik" class="table-of-contents__link toc-highlight">9.2.3 Inverse Kinematics (IK)</a></li><li><a href="#924-redundancy-7-dof-arms" class="table-of-contents__link toc-highlight">9.2.4 Redundancy (7-DOF Arms)</a></li></ul></li><li><a href="#93-moveit-2" class="table-of-contents__link toc-highlight">9.3 MoveIt 2</a><ul><li><a href="#931-moveit-architecture" class="table-of-contents__link toc-highlight">9.3.1 MoveIt Architecture</a></li><li><a href="#932-installation" class="table-of-contents__link toc-highlight">9.3.2 Installation</a></li><li><a href="#933-basic-usage" class="table-of-contents__link toc-highlight">9.3.3 Basic Usage</a></li><li><a href="#934-motion-planners" class="table-of-contents__link toc-highlight">9.3.4 Motion Planners</a></li></ul></li><li><a href="#94-grasp-planning" class="table-of-contents__link toc-highlight">9.4 Grasp Planning</a><ul><li><a href="#941-force-closure" class="table-of-contents__link toc-highlight">9.4.1 Force Closure</a></li><li><a href="#942-antipodal-grasps" class="table-of-contents__link toc-highlight">9.4.2 Antipodal Grasps</a></li><li><a href="#943-graspnet-learning-based" class="table-of-contents__link toc-highlight">9.4.3 GraspNet (Learning-Based)</a></li></ul></li><li><a href="#95-force-control" class="table-of-contents__link toc-highlight">9.5 Force Control</a><ul><li><a href="#951-impedance-control" class="table-of-contents__link toc-highlight">9.5.1 Impedance Control</a></li><li><a href="#952-admittance-control" class="table-of-contents__link toc-highlight">9.5.2 Admittance Control</a></li></ul></li><li><a href="#96-visual-servoing" class="table-of-contents__link toc-highlight">9.6 Visual Servoing</a><ul><li><a href="#961-position-based-visual-servoing-pbvs" class="table-of-contents__link toc-highlight">9.6.1 Position-Based Visual Servoing (PBVS)</a></li><li><a href="#962-image-based-visual-servoing-ibvs" class="table-of-contents__link toc-highlight">9.6.2 Image-Based Visual Servoing (IBVS)</a></li></ul></li><li><a href="#97-dual-arm-manipulation" class="table-of-contents__link toc-highlight">9.7 Dual-Arm Manipulation</a><ul><li><a href="#971-coordination" class="table-of-contents__link toc-highlight">9.7.1 Coordination</a></li></ul></li><li><a href="#98-whole-body-manipulation-humanoids" class="table-of-contents__link toc-highlight">9.8 Whole-Body Manipulation (Humanoids)</a></li><li><a href="#exercises" class="table-of-contents__link toc-highlight">Exercises</a><ul><li><a href="#exercise-91-compare-ik-solvers" class="table-of-contents__link toc-highlight">Exercise 9.1: Compare IK Solvers</a></li><li><a href="#exercise-92-stack-3-blocks" class="table-of-contents__link toc-highlight">Exercise 9.2: Stack 3 Blocks</a></li><li><a href="#exercise-93-train-graspnet-on-ycb-objects" class="table-of-contents__link toc-highlight">Exercise 9.3: Train GraspNet on YCB Objects</a></li></ul></li><li><a href="#citations" class="table-of-contents__link toc-highlight">Citations</a></li><li><a href="#hardware-requirements" class="table-of-contents__link toc-highlight">Hardware Requirements</a></li><li><a href="#labs" class="table-of-contents__link toc-highlight">Labs</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Textbook</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/physical-ai-textbook/docs/00-preface">Start Learning</a></li><li class="footer__item"><a class="footer__link-item" href="/physical-ai-textbook/docs/CHAPTER_OUTLINES">Chapter Outlines</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/Shumailaaijaz/physical-ai-labs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Labs Repository<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Shumailaaijaz/physical-ai-textbook" target="_blank" rel="noopener noreferrer" class="footer__link-item">Textbook Repository<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://github.com/Shumailaaijaz/physical-ai-textbook/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub Discussions<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/physical-ai-textbook/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/Shumailaaijaz/physical-ai-textbook/issues" target="_blank" rel="noopener noreferrer" class="footer__link-item">Report Issues<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2026 Physical AI Textbook. Open source under MIT License.<br><div style="margin-top: 1rem;"><a href="https://www.linkedin.com/in/shumaila-aijaz-916b412b3" target="_blank" rel="noopener noreferrer" style="display: inline-flex; align-items: center; gap: 0.5rem; text-decoration: none;"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg><span>Connect on LinkedIn</span></a></div></div></div></div></footer><div></div></div>
</body>
</html>