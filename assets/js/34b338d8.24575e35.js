"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[522],{54:(e,r,s)=>{s.d(r,{A:()=>l,O:()=>i});var t=s(6540),n=s(3223),o=s(4848);const a=(0,t.createContext)(void 0);function i({children:e}){const[r,s]=(0,t.useState)(null),[i,l]=(0,t.useState)(null),[u,c]=(0,t.useState)(null),[d,p]=(0,t.useState)(!0);async function h(e){try{const{data:r,error:t}=await n.N.from("personalization_profiles").select("*").eq("user_id",e).single();t?console.error("Error loading profile:",t):l(r),s({id:e})}catch(r){console.error("Error loading user data:",r)}finally{p(!1)}}(0,t.useEffect)(()=>{n.N.auth.getSession().then(({data:{session:e}})=>{c(e),e?.user?h(e.user.id):p(!1)});const{data:{subscription:e}}=n.N.auth.onAuthStateChange((e,r)=>{c(r),r?.user?h(r.user.id):(s(null),l(null),p(!1))});return()=>e.unsubscribe()},[]);const f={user:r,profile:i,session:u,loading:d,signIn:async function(e,r){const{data:s,error:t}=await n.N.auth.signInWithPassword({email:e,password:r});if(t)throw t;s.user&&await h(s.user.id)},signUp:async function(e,r,s){const{data:t,error:o}=await n.N.auth.signUp({email:e,password:r});if(o)throw o;if(t.user){const{error:e}=await n.N.from("personalization_profiles").insert({user_id:t.user.id,...s});e&&console.error("Error creating profile:",e),await n.N.from("sessions").insert({user_id:t.user.id,personalization_enabled:!1,language_preference:"en",last_active_at:(new Date).toISOString(),expires_at:new Date(Date.now()+6048e5).toISOString()}),await h(t.user.id)}},signOut:async function(){const{error:e}=await n.N.auth.signOut();if(e)throw e;s(null),l(null),c(null)},updateProfile:async function(e){if(!r)return;const{data:s,error:t}=await n.N.from("personalization_profiles").update({...e,updated_at:(new Date).toISOString()}).eq("user_id",r.id).select().single();if(t)throw console.error("Error updating profile:",t),t;l(s)}};return(0,o.jsx)(a.Provider,{value:f,children:e})}function l(){const e=(0,t.useContext)(a);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},2506:(e,r,s)=>{s.r(r),s.d(r,{default:()=>d});var t=s(6540),n=s(2633),o=s(8774),a=s(6025),i=s(54),l=s(7229),u=s(4848);function c(){const{signIn:e}=(0,i.A)(),r=(0,a.Ay)("/"),[s,n]=(0,t.useState)(""),[c,d]=(0,t.useState)(""),[p,h]=(0,t.useState)(!1),[f,m]=(0,t.useState)(null);return(0,u.jsxs)("form",{onSubmit:async t=>{t.preventDefault(),h(!0),m(null);try{await e(s,c);const t=new URLSearchParams(window.location.search).get("returnUrl")||r;window.location.href=t}catch(n){m("Invalid email or password")}finally{h(!1)}},className:l.A.authForm,children:[(0,u.jsx)("h2",{children:"Sign In"}),(0,u.jsx)("p",{className:l.A.subtitle,children:"Welcome back! Access your personalized textbook"}),f&&(0,u.jsxs)("div",{className:l.A.error,children:["\u26a0\ufe0f ",f]}),(0,u.jsxs)("div",{className:l.A.formGroup,children:[(0,u.jsx)("label",{htmlFor:"email",children:"Email"}),(0,u.jsx)("input",{id:"email",type:"email",value:s,onChange:e=>n(e.target.value),required:!0,placeholder:"your.email@example.com",autoComplete:"email"})]}),(0,u.jsxs)("div",{className:l.A.formGroup,children:[(0,u.jsx)("label",{htmlFor:"password",children:"Password"}),(0,u.jsx)("input",{id:"password",type:"password",value:c,onChange:e=>d(e.target.value),required:!0,placeholder:"Your password",autoComplete:"current-password"})]}),(0,u.jsx)("button",{type:"submit",className:l.A.submitButton,disabled:p,children:p?"Signing in...":"Sign In"}),(0,u.jsxs)("p",{className:l.A.switchForm,children:["Don't have an account?"," ",(0,u.jsx)(o.A,{to:"/signup",children:"Create one here"})]})]})}function d(){return(0,u.jsx)(i.O,{children:(0,u.jsx)(n.A,{title:"Sign In",description:"Sign in to access your personalized Physical AI textbook",children:(0,u.jsx)("main",{style:{minHeight:"70vh",paddingTop:"2rem",paddingBottom:"2rem"},children:(0,u.jsx)(c,{})})})})}},3223:(e,r,s)=>{s.d(r,{N:()=>i});var t=s(2578);const n=(e,r)=>"undefined"!=typeof process&&process.env&&process.env[e]||r,o=n("SUPABASE_URL","https://placeholder.supabase.co"),a=n("SUPABASE_ANON_KEY","placeholder-key");"undefined"!=typeof process&&process.env&&process.env.SUPABASE_URL&&process.env.SUPABASE_ANON_KEY||"undefined"==typeof window||console.warn("Supabase environment variables not set. Database features will be disabled.");const i=(0,t.UU)(o,a,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}})},7229:(e,r,s)=>{s.d(r,{A:()=>t});const t={authForm:"authForm_WxR6",subtitle:"subtitle_xng4",formGroup:"formGroup_ul3Y",divider:"divider_bmWp",personalizeInfo:"personalizeInfo_hyeY",submitButton:"submitButton_XNI3",error:"error_J0pE",success:"success_fV5n",switchForm:"switchForm_b6rg"}}}]);